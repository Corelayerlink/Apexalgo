2025-07-31 17:43:34,846 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 17:43:34,847 - ib_insync.client - INFO - Connected
2025-07-31 17:43:34,891 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 17:43:34,905 - ib_insync.client - INFO - API connection ready
2025-07-31 17:43:34,907 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 17:43:34,907 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 17:43:34,907 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 17:43:34,908 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:43:35,213 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8200073, marketValue=847.28, averageCost=200.46255, unrealizedPNL=45.43, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:43:35,315 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 17:44:28,051 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 17:44:28,052 - ib_insync.client - INFO - Connected
2025-07-31 17:44:28,054 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 17:44:28,106 - ib_insync.client - INFO - API connection ready
2025-07-31 17:44:28,106 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 17:44:28,106 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 17:44:28,106 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 17:44:28,107 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:44:28,412 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8200073, marketValue=847.28, averageCost=200.46255, unrealizedPNL=45.43, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:44:28,513 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 17:44:31,513 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.30000305, marketValue=849.2, averageCost=200.46255, unrealizedPNL=47.35, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:47:31,519 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0399933, marketValue=848.16, averageCost=200.46255, unrealizedPNL=46.31, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:48:23,112 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:49:07,851 - ib_insync.ib - INFO - placeOrder: New order Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=LimitOrder(orderId=4, clientId=199, action='BUY', totalQuantity=10.0, lmtPrice=150.0, transmit=False), orderStatus=OrderStatus(orderId=4, status='PendingSubmit', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 851316, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0)], advancedError='')
2025-07-31 17:49:07,852 - ib_insync.ib - INFO - placeOrder: New order Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=LimitOrder(orderId=5, clientId=199, action='SELL', totalQuantity=10.0, lmtPrice=155.0, transmit=False, parentId=4), orderStatus=OrderStatus(orderId=5, status='PendingSubmit', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 852366, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0)], advancedError='')
2025-07-31 17:49:07,853 - ib_insync.ib - INFO - placeOrder: New order Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=StopOrder(orderId=6, clientId=199, action='SELL', totalQuantity=10.0, auxPrice=145.0, parentId=4), orderStatus=OrderStatus(orderId=6, status='PendingSubmit', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 853072, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0)], advancedError='')
2025-07-31 17:49:08,229 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=LimitOrder(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, lmtPrice=150.0, auxPrice=0.0, transmit=False), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 851316, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0), TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 8, 227124, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:49:08,230 - ib_insync.wrapper - INFO - Warning 399, reqId 4: Order Message: BUY 10 AAPL NASDAQ.NMS Warning: Your order will not be placed at the exchange until 2025-08-01 09:30:00 US/Eastern.
2025-07-31 17:49:08,232 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=LimitOrder(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, lmtPrice=155.0, auxPrice=0.0, transmit=False, parentId=4), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 852366, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0), TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 8, 230287, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:49:08,233 - ib_insync.wrapper - INFO - Warning 399, reqId 5: Order Message: SELL 10 AAPL NASDAQ.NMS Warning: Your order will not be placed at the exchange until 2025-08-01 09:30:00 US/Eastern.
2025-07-31 17:49:08,234 - ib_insync.wrapper - INFO - Warning 399, reqId 6: Order Message: SELL 10 AAPL NASDAQ.NMS Warning: Your order will not be placed at the exchange until 2025-08-01 09:30:00 US/Eastern.
2025-07-31 17:49:08,236 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(symbol='AAPL', exchange='SMART', currency='USD'), order=StopOrder(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, lmtPrice=0.0, auxPrice=145.0, parentId=4), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 7, 853072, tzinfo=datetime.timezone.utc), status='PendingSubmit', message='', errorCode=0), TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 49, 8, 233007, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:50:31,524 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8500061, marketValue=847.4, averageCost=200.46255, unrealizedPNL=45.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:53:31,533 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.80999755, marketValue=847.24, averageCost=200.46255, unrealizedPNL=45.39, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:54:45,771 - root - INFO - Data gap found for AAPL. Fetching from broker from 2023-01-01 00:00:00 to 2024-01-01.
2025-07-31 17:54:45,771 - root - INFO - MockBroker: Getting historical data for AAPL from 2023-01-01 to 2024-01-01
2025-07-31 17:54:45,892 - root - ERROR - Failed to backfill data from broker: Invalid frequency: 1 day, failed to parse with error message: ValueError("Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')")
Traceback (most recent call last):
  File "offsets.pyx", line 4776, in pandas._libs.tslibs.offsets._get_offset
KeyError: 'DAY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "offsets.pyx", line 4946, in pandas._libs.tslibs.offsets.to_offset
  File "offsets.pyx", line 4782, in pandas._libs.tslibs.offsets._get_offset
ValueError: Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/generic.py", line 9771, in resample
    return get_resampler(
           ^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 2049, in get_resampler
    tg = TimeGrouper(obj, **kwds)  # type: ignore[arg-type]
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 2143, in __init__
    freq = to_offset(freq)
           ^^^^^^^^^^^^^^^
  File "offsets.pyx", line 4791, in pandas._libs.tslibs.offsets.to_offset
  File "offsets.pyx", line 4954, in pandas._libs.tslibs.offsets.to_offset
ValueError: Invalid frequency: 1 day, failed to parse with error message: ValueError("Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')")
2025-07-31 17:54:45,912 - root - ERROR - Backtest failed: 500: Failed to backfill data from broker: Invalid frequency: 1 day, failed to parse with error message: ValueError("Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')")
Traceback (most recent call last):
  File "offsets.pyx", line 4776, in pandas._libs.tslibs.offsets._get_offset
KeyError: 'DAY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "offsets.pyx", line 4946, in pandas._libs.tslibs.offsets.to_offset
  File "offsets.pyx", line 4782, in pandas._libs.tslibs.offsets._get_offset
ValueError: Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/generic.py", line 9771, in resample
    return get_resampler(
           ^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 2049, in get_resampler
    tg = TimeGrouper(obj, **kwds)  # type: ignore[arg-type]
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 2143, in __init__
    freq = to_offset(freq)
           ^^^^^^^^^^^^^^^
  File "offsets.pyx", line 4791, in pandas._libs.tslibs.offsets.to_offset
  File "offsets.pyx", line 4954, in pandas._libs.tslibs.offsets.to_offset
ValueError: Invalid frequency: 1 day, failed to parse with error message: ValueError("Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 425, in run_backtest
    data = await get_smart_data(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 242, in get_smart_data
    raise HTTPException(status_code=500, detail=f"Failed to backfill data from broker: {e}")
fastapi.exceptions.HTTPException: 500: Failed to backfill data from broker: Invalid frequency: 1 day, failed to parse with error message: ValueError("Invalid frequency: DAY, failed to parse with error message: KeyError('DAY')")
2025-07-31 17:55:39,107 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 1.32 kB sent in 15 messages, 87.3 kB received in 1784 messages, session time 671 s.
2025-07-31 17:55:39,107 - ib_insync.client - INFO - Disconnecting
2025-07-31 17:55:39,107 - ib_insync.client - INFO - Disconnected.
2025-07-31 17:55:44,150 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 17:55:44,151 - ib_insync.client - INFO - Connected
2025-07-31 17:55:44,154 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 17:55:44,191 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:55:44,191 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 55, 44, 190873, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:55:44,192 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:55:44,192 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 55, 44, 191872, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:55:44,192 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:55:44,192 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 55, 44, 192490, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:55:44,193 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 17:55:44,193 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 17:55:44,193 - ib_insync.client - INFO - API connection ready
2025-07-31 17:55:44,193 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 17:55:44,197 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:55:44,500 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.80999755, marketValue=847.24, averageCost=200.46255, unrealizedPNL=45.39, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:55:44,605 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 17:56:31,570 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0, marketValue=848.0, averageCost=200.46255, unrealizedPNL=46.15, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:56:38,527 - root - INFO - Data gap found for AAPL. Fetching from broker from 2025-01-01 00:00:00 to 2025-06-06.
2025-07-31 17:56:38,527 - root - INFO - MockBroker: Getting historical data for AAPL from 2025-01-01 to 2025-06-06
2025-07-31 17:56:38,579 - root - ERROR - Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:56:38,585 - root - ERROR - Backtest failed: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 435, in run_backtest
    data = await get_smart_data(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 242, in get_smart_data
    raise HTTPException(status_code=500, detail=f"Failed to backfill data from broker: {e}")
fastapi.exceptions.HTTPException: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:56:53,331 - root - INFO - Data gap found for AAPL. Fetching from broker from 2023-12-31 00:00:01 to 2024-01-01.
2025-07-31 17:56:53,331 - root - INFO - MockBroker: Getting historical data for AAPL from 2023-12-31 to 2024-01-01
2025-07-31 17:56:53,339 - root - ERROR - Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:56:53,340 - root - ERROR - Backtest failed: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 435, in run_backtest
    data = await get_smart_data(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 242, in get_smart_data
    raise HTTPException(status_code=500, detail=f"Failed to backfill data from broker: {e}")
fastapi.exceptions.HTTPException: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:57:05,211 - root - INFO - Data gap found for AAPL. Fetching from broker from 2023-12-31 00:00:01 to 2024-01-01.
2025-07-31 17:57:05,211 - root - INFO - MockBroker: Getting historical data for AAPL from 2023-12-31 to 2024-01-01
2025-07-31 17:57:05,220 - root - ERROR - Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:57:05,222 - root - ERROR - Backtest failed: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 232, in get_smart_data
    broker_data = broker_data.resample(timeframe).agg(agg_rules).dropna()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/resample.py", line 352, in aggregate
    result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 435, in run_backtest
    data = await get_smart_data(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 242, in get_smart_data
    raise HTTPException(status_code=500, detail=f"Failed to backfill data from broker: {e}")
fastapi.exceptions.HTTPException: 500: Failed to backfill data from broker: "Column(s) ['Close', 'High', 'Low', 'Open', 'Volume'] do not exist"
2025-07-31 17:58:26,717 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 30.1 kB received in 558 messages, session time 163 s.
2025-07-31 17:58:26,717 - ib_insync.client - INFO - Disconnecting
2025-07-31 17:58:26,718 - ib_insync.client - INFO - Disconnected.
2025-07-31 17:58:31,817 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 17:58:31,817 - ib_insync.client - INFO - Connected
2025-07-31 17:58:31,821 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 17:58:31,853 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:58:31,853 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 58, 31, 852904, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:58:31,854 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:58:31,854 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 58, 31, 853898, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:58:31,854 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:58:31,855 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 58, 31, 854536, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:58:31,855 - ib_insync.client - INFO - API connection ready
2025-07-31 17:58:31,855 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 17:58:31,855 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 17:58:31,855 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 17:58:31,856 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:58:32,159 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0, marketValue=848.0, averageCost=200.46255, unrealizedPNL=46.15, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:58:32,260 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 17:58:45,133 - root - INFO - Data gap found for AAPL. Fetching from broker from 2023-12-31 00:00:01 to 2024-01-01.
2025-07-31 17:58:45,133 - root - INFO - MockBroker: Getting historical data for AAPL from 2023-12-31 to 2024-01-01
2025-07-31 17:59:27,965 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 56.4 s.
2025-07-31 17:59:27,965 - ib_insync.client - INFO - Disconnecting
2025-07-31 17:59:27,966 - ib_insync.client - INFO - Disconnected.
2025-07-31 17:59:33,240 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 17:59:33,241 - ib_insync.client - INFO - Connected
2025-07-31 17:59:33,243 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 17:59:33,264 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:59:33,265 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 59, 33, 263745, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:59:33,265 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:59:33,266 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 59, 33, 265586, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:59:33,266 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 17:59:33,267 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 22, 59, 33, 265586, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 17:59:33,267 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 17:59:33,267 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 17:59:33,267 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 17:59:33,267 - ib_insync.client - INFO - API connection ready
2025-07-31 17:59:33,269 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 17:59:33,574 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.30999755, marketValue=849.24, averageCost=200.46255, unrealizedPNL=47.39, realizedPNL=0.0, account='DU7910303')
2025-07-31 17:59:33,674 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 17:59:47,370 - root - INFO - Data gap found for AAPL. Fetching from broker from 2023-12-31 00:00:01 to 2024-01-01.
2025-07-31 17:59:47,370 - root - INFO - MockBroker: Getting historical data for AAPL from 2023-12-31 to 2024-01-01
2025-07-31 17:59:47,373 - root - ERROR - Failed to backfill data from broker: object DataFrame can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 222, in get_smart_data
    broker_data = await broker.get_historical_data(symbol, ibkr_timeframe, fetch_start_date.strftime('%Y-%m-%d'), end_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object DataFrame can't be used in 'await' expression
2025-07-31 17:59:47,374 - root - ERROR - Backtest failed: 500: Failed to backfill data from broker: object DataFrame can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 222, in get_smart_data
    broker_data = await broker.get_historical_data(symbol, ibkr_timeframe, fetch_start_date.strftime('%Y-%m-%d'), end_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object DataFrame can't be used in 'await' expression

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 441, in run_backtest
    data = await get_smart_data(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 248, in get_smart_data
    raise HTTPException(status_code=500, detail=f"Failed to backfill data from broker: {e}")
fastapi.exceptions.HTTPException: 500: Failed to backfill data from broker: object DataFrame can't be used in 'await' expression
2025-07-31 18:01:12,689 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 99.7 s.
2025-07-31 18:01:12,689 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:01:12,690 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:01:17,783 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:01:17,783 - ib_insync.client - INFO - Connected
2025-07-31 18:01:17,787 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:01:17,840 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:01:17,840 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 1, 17, 839625, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:01:17,841 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:01:17,841 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 1, 17, 840635, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:01:17,841 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:01:17,841 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 1, 17, 840635, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:01:17,841 - ib_insync.client - INFO - API connection ready
2025-07-31 18:01:17,842 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:01:17,842 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:01:17,842 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:01:17,844 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:01:18,148 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.30999755, marketValue=849.24, averageCost=200.46255, unrealizedPNL=47.39, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:01:18,249 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:02:28,722 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:02:28,749 - ib_insync.wrapper - ERROR - Error 321, reqId 9: Error validating request.-'bL' : cause - Historical data bar size setting is invalid. Legal ones are: 1 secs, 5 secs, 10 secs, 15 secs, 30 secs, 1 min, 2 mins, 3 mins, 5 mins, 10 mins, 15 mins, 20 mins, 30 mins, 1 hour, 2 hours, 3 hours, 4 hours, 8 hours, 1 day, 1W, 1M, contract: Stock(symbol='TSLA', exchange='SMART', currency='USD')
2025-07-31 18:02:28,750 - root - ERROR - Failed to backfill data from broker: object DataFrame can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 222, in get_smart_data
    broker_data = await broker.get_historical_data(symbol, ibkr_timeframe, fetch_start_date.strftime('%Y-%m-%d'), end_date)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object DataFrame can't be used in 'await' expression
2025-07-31 18:02:31,512 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.9900055, marketValue=847.96, averageCost=200.46255, unrealizedPNL=46.11, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:03:06,748 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 205 B sent in 9 messages, 30.4 kB received in 559 messages, session time 109 s.
2025-07-31 18:03:06,749 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:03:06,749 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:03:11,984 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:03:11,985 - ib_insync.client - INFO - Connected
2025-07-31 18:03:11,987 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:03:12,021 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:12,022 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 12, 21156, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:12,022 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:12,022 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 12, 22440, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:12,023 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:12,023 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 12, 22440, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:12,023 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:03:12,024 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:03:12,024 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:03:12,024 - ib_insync.client - INFO - API connection ready
2025-07-31 18:03:12,025 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:03:12,329 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.9900055, marketValue=847.96, averageCost=200.46255, unrealizedPNL=46.11, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:03:12,431 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:03:13,850 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 2.17 s.
2025-07-31 18:03:13,850 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:03:13,851 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:03:18,651 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:03:18,651 - ib_insync.client - INFO - Connected
2025-07-31 18:03:18,653 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:03:18,671 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:18,671 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 18, 671256, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:18,672 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:18,672 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 18, 672034, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:18,673 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:03:18,673 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 3, 18, 672034, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:03:18,673 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:03:18,673 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:03:18,673 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:03:18,673 - ib_insync.client - INFO - API connection ready
2025-07-31 18:03:18,675 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:03:18,979 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.9900055, marketValue=847.96, averageCost=200.46255, unrealizedPNL=46.11, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:03:19,080 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:04:05,320 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 46.9 s.
2025-07-31 18:04:05,320 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:04:05,320 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:04:10,094 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:04:10,094 - ib_insync.client - INFO - Connected
2025-07-31 18:04:10,096 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:04:10,119 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:04:10,119 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 4, 10, 118154, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:04:10,119 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:04:10,120 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 4, 10, 119522, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:04:10,120 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:04:10,120 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 4, 10, 119522, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:04:10,120 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:04:10,120 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:04:10,120 - ib_insync.client - INFO - API connection ready
2025-07-31 18:04:10,121 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:04:10,122 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:04:10,423 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.9900055, marketValue=847.96, averageCost=200.46255, unrealizedPNL=46.11, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:04:10,528 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:05:31,628 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0099945, marketValue=848.04, averageCost=200.46255, unrealizedPNL=46.19, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:05:35,973 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 30.1 kB received in 558 messages, session time 86.2 s.
2025-07-31 18:05:35,973 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:05:35,974 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:05:41,144 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:05:41,145 - ib_insync.client - INFO - Connected
2025-07-31 18:05:41,149 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:05:41,181 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:05:41,181 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 5, 41, 180915, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:05:41,182 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:05:41,182 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 5, 41, 182042, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:05:41,183 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:05:41,183 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 5, 41, 182042, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:05:41,183 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:05:41,184 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:05:41,184 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:05:41,184 - ib_insync.client - INFO - API connection ready
2025-07-31 18:05:41,186 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:05:41,490 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0099945, marketValue=848.04, averageCost=200.46255, unrealizedPNL=46.19, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:05:41,591 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:07:00,656 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:07:00,663 - ib_insync.wrapper - ERROR - Error 321, reqId 9: Error validating request.-'bL' : cause - Historical data bar size setting is invalid. Legal ones are: 1 secs, 5 secs, 10 secs, 15 secs, 30 secs, 1 min, 2 mins, 3 mins, 5 mins, 10 mins, 15 mins, 20 mins, 30 mins, 1 hour, 2 hours, 3 hours, 4 hours, 8 hours, 1 day, 1W, 1M, contract: Stock(symbol='TSLA', exchange='SMART', currency='USD')
2025-07-31 18:08:31,520 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.1000061, marketValue=848.4, averageCost=200.46255, unrealizedPNL=46.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:09:25,044 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 205 B sent in 9 messages, 30.4 kB received in 559 messages, session time 224 s.
2025-07-31 18:09:25,045 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:09:25,045 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:09:30,237 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:09:30,237 - ib_insync.client - INFO - Connected
2025-07-31 18:09:30,240 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:09:30,284 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:09:30,284 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 9, 30, 283578, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:09:30,285 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:09:30,285 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 9, 30, 284780, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:09:30,286 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:09:30,286 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 9, 30, 284780, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:09:30,286 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:09:30,286 - ib_insync.wrapper - INFO - Warning 2107, reqId -1: HMDS data farm connection is inactive but should be available upon demand.ushmds
2025-07-31 18:09:30,286 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:09:30,286 - ib_insync.client - INFO - API connection ready
2025-07-31 18:09:30,288 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:09:30,595 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.1000061, marketValue=848.4, averageCost=200.46255, unrealizedPNL=46.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:09:30,693 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:09:51,339 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:09:52,027 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:09:52,125 - root - ERROR - Failed to backfill data from broker: DataFrame index must be a DatetimeIndex.
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 233, in get_smart_data
    data_manager.save_bars(symbol, '1min', broker_data)
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 84, in save_bars
    raise ValueError("DataFrame index must be a DatetimeIndex.")
ValueError: DataFrame index must be a DatetimeIndex.
2025-07-31 18:11:19,996 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 208 B sent in 9 messages, 25.3 kB received in 412 messages, session time 110 s.
2025-07-31 18:11:19,997 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:11:19,997 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:11:25,122 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:11:25,122 - ib_insync.client - INFO - Connected
2025-07-31 18:11:25,124 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:11:25,159 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:11:25,159 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 11, 25, 158674, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:11:25,159 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 11, 25, 159614, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 11, 25, 159614, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:11:25,160 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:11:25,161 - ib_insync.client - INFO - API connection ready
2025-07-31 18:11:25,162 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:11:25,466 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.1000061, marketValue=848.4, averageCost=200.46255, unrealizedPNL=46.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:11:25,567 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:11:27,218 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:11:27,303 - root - ERROR - Failed to backfill data from broker: DataFrame index must be a DatetimeIndex.
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 233, in get_smart_data
    data_manager.save_bars(symbol, '1min', broker_data)
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 84, in save_bars
    raise ValueError("DataFrame index must be a DatetimeIndex.")
ValueError: DataFrame index must be a DatetimeIndex.
2025-07-31 18:11:31,517 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.02000425, marketValue=848.08, averageCost=200.46255, unrealizedPNL=46.23, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:11:48,694 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:11:48,782 - root - ERROR - Failed to backfill data from broker: DataFrame index must be a DatetimeIndex.
Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 233, in get_smart_data
    data_manager.save_bars(symbol, '1min', broker_data)
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 84, in save_bars
    raise ValueError("DataFrame index must be a DatetimeIndex.")
ValueError: DataFrame index must be a DatetimeIndex.
2025-07-31 18:12:32,161 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 298 B sent in 10 messages, 34.1 kB received in 560 messages, session time 67.3 s.
2025-07-31 18:12:32,161 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:12:32,161 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:12:37,158 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:12:37,158 - ib_insync.client - INFO - Connected
2025-07-31 18:12:37,160 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:12:37,194 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:12:37,195 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 12, 37, 193634, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:12:37,195 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:12:37,195 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 12, 37, 195338, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:12:37,196 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:12:37,196 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 12, 37, 196000, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:12:37,196 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:12:37,196 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:12:37,197 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:12:37,197 - ib_insync.client - INFO - API connection ready
2025-07-31 18:12:37,199 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:12:37,502 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.02000425, marketValue=848.08, averageCost=200.46255, unrealizedPNL=46.23, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:12:37,603 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:12:49,129 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:12:49,229 - root - ERROR - Failed to backfill data from broker: (sqlite3.OperationalError) table market_data has no column named date
[SQL: INSERT INTO market_data (date, open, high, low, close, volume, average, "barCount", symbol, timeframe) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT (timestamp, symbol, timeframe) DO UPDATE SET date = excluded.date, open = excluded.open, high = excluded.high, low = excluded.low, close = excluded.close, volume = excluded.volume, average = excluded.average, "barCount" = excluded."barCount"]
[parameters: (datetime.datetime(2022, 12, 15, 0, 0), 153.41, 160.93, 153.28, 157.67, 94057500.0, 157.758, 344984, 'TSLA', '1min', datetime.datetime(2022, 12, 16, 0, 0), 159.6, 160.99, 150.04, 150.23, 92985121.0, 152.398, 348025, 'TSLA', '1min', datetime.datetime(2022, 12, 19, 0, 0), 154.0, 155.25, 145.82, 149.87, 110675054.0, 150.349, 399331, 'TSLA', '1min', datetime.datetime(2022, 12, 20, 0, 0), 146.1, 148.47, 137.66, 137.8, 124359517.0, 142.762, 444868, 'TSLA', '1min', datetime.datetime(2022, 12, 21, 0, 0), 139.35, 141.26, 135.91, 137.57, 117668769.0, 138.711, 418499, 'TSLA', '1min' ... 210 parameters truncated ... datetime.datetime(2023, 1, 25, 0, 0), 141.91, 146.41, 138.07, 144.43, 143416941.0, 142.772, 442551, 'TSLA', '1min', datetime.datetime(2023, 1, 26, 0, 0), 159.95, 161.42, 154.76, 160.27, 184608139.0, 157.832, 611813, 'TSLA', '1min', datetime.datetime(2023, 1, 27, 0, 0), 162.43, 180.68, 161.17, 177.9, 251031742.0, 173.15, 842113, 'TSLA', '1min', datetime.datetime(2023, 1, 30, 0, 0), 178.05, 179.77, 166.5, 166.66, 185213017.0, 172.197, 601373, 'TSLA', '1min', datetime.datetime(2023, 1, 31, 0, 0), 164.57, 174.3, 162.78, 173.22, 164231786.0, 170.961, 527681, 'TSLA', '1min')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table market_data has no column named date

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 233, in get_smart_data
    data_manager.save_bars(symbol, '1min', broker_data)
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 97, in save_bars
    df_copy.to_sql(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 131, in _sqlite_upsert
    conn.execute(upsert_stmt)
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table market_data has no column named date
[SQL: INSERT INTO market_data (date, open, high, low, close, volume, average, "barCount", symbol, timeframe) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT (timestamp, symbol, timeframe) DO UPDATE SET date = excluded.date, open = excluded.open, high = excluded.high, low = excluded.low, close = excluded.close, volume = excluded.volume, average = excluded.average, "barCount" = excluded."barCount"]
[parameters: (datetime.datetime(2022, 12, 15, 0, 0), 153.41, 160.93, 153.28, 157.67, 94057500.0, 157.758, 344984, 'TSLA', '1min', datetime.datetime(2022, 12, 16, 0, 0), 159.6, 160.99, 150.04, 150.23, 92985121.0, 152.398, 348025, 'TSLA', '1min', datetime.datetime(2022, 12, 19, 0, 0), 154.0, 155.25, 145.82, 149.87, 110675054.0, 150.349, 399331, 'TSLA', '1min', datetime.datetime(2022, 12, 20, 0, 0), 146.1, 148.47, 137.66, 137.8, 124359517.0, 142.762, 444868, 'TSLA', '1min', datetime.datetime(2022, 12, 21, 0, 0), 139.35, 141.26, 135.91, 137.57, 117668769.0, 138.711, 418499, 'TSLA', '1min' ... 210 parameters truncated ... datetime.datetime(2023, 1, 25, 0, 0), 141.91, 146.41, 138.07, 144.43, 143416941.0, 142.772, 442551, 'TSLA', '1min', datetime.datetime(2023, 1, 26, 0, 0), 159.95, 161.42, 154.76, 160.27, 184608139.0, 157.832, 611813, 'TSLA', '1min', datetime.datetime(2023, 1, 27, 0, 0), 162.43, 180.68, 161.17, 177.9, 251031742.0, 173.15, 842113, 'TSLA', '1min', datetime.datetime(2023, 1, 30, 0, 0), 178.05, 179.77, 166.5, 166.66, 185213017.0, 172.197, 601373, 'TSLA', '1min', datetime.datetime(2023, 1, 31, 0, 0), 164.57, 174.3, 162.78, 173.22, 164231786.0, 170.961, 527681, 'TSLA', '1min')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-31 18:13:06,545 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 208 B sent in 9 messages, 25.2 kB received in 411 messages, session time 29.7 s.
2025-07-31 18:13:06,545 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:13:06,545 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:13:11,669 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:13:11,669 - ib_insync.client - INFO - Connected
2025-07-31 18:13:11,672 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:13:11,724 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:11,724 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 11, 723687, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:11,725 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:11,725 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 11, 724907, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:11,725 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:11,726 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 11, 724907, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:11,726 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:13:11,726 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:13:11,726 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:13:11,726 - ib_insync.client - INFO - API connection ready
2025-07-31 18:13:11,728 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:13:12,033 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.02000425, marketValue=848.08, averageCost=200.46255, unrealizedPNL=46.23, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:13:12,133 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:13:35,259 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:13:35,362 - root - ERROR - Failed to backfill data from broker: (sqlite3.OperationalError) table market_data has no column named date
[SQL: INSERT INTO market_data (date, open, high, low, close, volume, symbol, timeframe) VALUES (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT (timestamp, symbol, timeframe) DO UPDATE SET date = excluded.date, open = excluded.open, high = excluded.high, low = excluded.low, close = excluded.close, volume = excluded.volume]
[parameters: (datetime.datetime(2022, 12, 15, 0, 0), 153.41, 160.93, 153.28, 157.67, 94057500.0, 'TSLA', '1min', datetime.datetime(2022, 12, 16, 0, 0), 159.6, 160.99, 150.04, 150.23, 92985121.0, 'TSLA', '1min', datetime.datetime(2022, 12, 19, 0, 0), 154.0, 155.25, 145.82, 149.87, 110675054.0, 'TSLA', '1min', datetime.datetime(2022, 12, 20, 0, 0), 146.1, 148.47, 137.66, 137.8, 124359517.0, 'TSLA', '1min', datetime.datetime(2022, 12, 21, 0, 0), 139.35, 141.26, 135.91, 137.57, 117668769.0, 'TSLA', '1min', datetime.datetime(2022, 12, 22, 0, 0), 135.98, 136.63, 122.26, 125.35, 167175255.0, 'TSLA', '1min', datetime.datetime(2022, 12, 23, 0, 0), 126.37 ... 148 parameters truncated ... 'TSLA', '1min', datetime.datetime(2023, 1, 24, 0, 0), 143.0, 146.5, 141.1, 143.89, 131589171.0, 'TSLA', '1min', datetime.datetime(2023, 1, 25, 0, 0), 141.91, 146.41, 138.07, 144.43, 143416941.0, 'TSLA', '1min', datetime.datetime(2023, 1, 26, 0, 0), 159.95, 161.42, 154.76, 160.27, 184608139.0, 'TSLA', '1min', datetime.datetime(2023, 1, 27, 0, 0), 162.43, 180.68, 161.17, 177.9, 251031742.0, 'TSLA', '1min', datetime.datetime(2023, 1, 30, 0, 0), 178.05, 179.77, 166.5, 166.66, 185213017.0, 'TSLA', '1min', datetime.datetime(2023, 1, 31, 0, 0), 164.57, 174.3, 162.78, 173.22, 164231786.0, 'TSLA', '1min')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: table market_data has no column named date

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/mayur/CoreLayerLink/Apexalgo/api/main.py", line 253, in get_smart_data
    data_manager.save_bars(symbol, '1min', broker_data)
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 97, in save_bars
    df_copy.to_sql(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/core/generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1567, in insert_records
    raise err
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/pandas/io/sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/CoreLayerLink/Apexalgo/data/data_manager.py", line 131, in _sqlite_upsert
    conn.execute(upsert_stmt)
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/mayur/miniconda3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table market_data has no column named date
[SQL: INSERT INTO market_data (date, open, high, low, close, volume, symbol, timeframe) VALUES (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?), (?, ?, ?, ?, ?, ?, ?, ?) ON CONFLICT (timestamp, symbol, timeframe) DO UPDATE SET date = excluded.date, open = excluded.open, high = excluded.high, low = excluded.low, close = excluded.close, volume = excluded.volume]
[parameters: (datetime.datetime(2022, 12, 15, 0, 0), 153.41, 160.93, 153.28, 157.67, 94057500.0, 'TSLA', '1min', datetime.datetime(2022, 12, 16, 0, 0), 159.6, 160.99, 150.04, 150.23, 92985121.0, 'TSLA', '1min', datetime.datetime(2022, 12, 19, 0, 0), 154.0, 155.25, 145.82, 149.87, 110675054.0, 'TSLA', '1min', datetime.datetime(2022, 12, 20, 0, 0), 146.1, 148.47, 137.66, 137.8, 124359517.0, 'TSLA', '1min', datetime.datetime(2022, 12, 21, 0, 0), 139.35, 141.26, 135.91, 137.57, 117668769.0, 'TSLA', '1min', datetime.datetime(2022, 12, 22, 0, 0), 135.98, 136.63, 122.26, 125.35, 167175255.0, 'TSLA', '1min', datetime.datetime(2022, 12, 23, 0, 0), 126.37 ... 148 parameters truncated ... 'TSLA', '1min', datetime.datetime(2023, 1, 24, 0, 0), 143.0, 146.5, 141.1, 143.89, 131589171.0, 'TSLA', '1min', datetime.datetime(2023, 1, 25, 0, 0), 141.91, 146.41, 138.07, 144.43, 143416941.0, 'TSLA', '1min', datetime.datetime(2023, 1, 26, 0, 0), 159.95, 161.42, 154.76, 160.27, 184608139.0, 'TSLA', '1min', datetime.datetime(2023, 1, 27, 0, 0), 162.43, 180.68, 161.17, 177.9, 251031742.0, 'TSLA', '1min', datetime.datetime(2023, 1, 30, 0, 0), 178.05, 179.77, 166.5, 166.66, 185213017.0, 'TSLA', '1min', datetime.datetime(2023, 1, 31, 0, 0), 164.57, 174.3, 162.78, 173.22, 164231786.0, 'TSLA', '1min')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-31 18:13:51,278 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 208 B sent in 9 messages, 25.2 kB received in 411 messages, session time 39.9 s.
2025-07-31 18:13:51,278 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:13:51,279 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:13:56,416 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:13:56,417 - ib_insync.client - INFO - Connected
2025-07-31 18:13:56,419 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:13:56,453 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:56,454 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 56, 452653, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:56,455 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:56,455 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 56, 454799, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:56,455 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:13:56,456 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 13, 56, 455637, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:13:56,456 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:13:56,456 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:13:56,456 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:13:56,456 - ib_insync.client - INFO - API connection ready
2025-07-31 18:13:56,458 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:13:56,759 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.02000425, marketValue=848.08, averageCost=200.46255, unrealizedPNL=46.23, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:13:56,864 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:14:31,551 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.16999815, marketValue=848.68, averageCost=200.46255, unrealizedPNL=46.83, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:14:52,214 - root - INFO - Data gap found for TSLA. Fetching from broker from 2023-01-01 00:00:00 to 2023-02-01.
2025-07-31 18:17:10,379 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 208 B sent in 9 messages, 32.1 kB received in 559 messages, session time 194 s.
2025-07-31 18:17:10,380 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:17:10,381 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:17:15,728 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:17:15,728 - ib_insync.client - INFO - Connected
2025-07-31 18:17:15,732 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:17:15,776 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:15,777 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 15, 776177, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:15,777 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:15,777 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 15, 777118, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:15,778 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:15,778 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 15, 777118, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:15,778 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:17:15,778 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:17:15,778 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:17:15,778 - ib_insync.client - INFO - API connection ready
2025-07-31 18:17:15,780 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:17:16,084 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.16999815, marketValue=848.68, averageCost=200.46255, unrealizedPNL=46.83, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:17:16,186 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:17:21,104 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:17:21,104 - ib_insync.client - INFO - Connected
2025-07-31 18:17:21,108 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:17:21,131 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:21,132 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 21, 131178, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:21,132 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:21,132 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 21, 132204, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:21,133 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:17:21,133 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 17, 21, 132204, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:17:21,133 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:17:21,133 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:17:21,133 - ib_insync.client - INFO - API connection ready
2025-07-31 18:17:21,134 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:17:21,134 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:17:21,439 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.16999815, marketValue=848.68, averageCost=200.46255, unrealizedPNL=46.83, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:17:21,541 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:17:31,556 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.05000305, marketValue=848.2, averageCost=200.46255, unrealizedPNL=46.35, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:19:09,743 - root - ERROR - An error occurred in the WebSocket for TEST: MockBroker.stream_market_data() takes 3 positional arguments but 4 were given
2025-07-31 18:19:09,744 - root - INFO - WebSocket for TEST closed and cleaned up.
2025-07-31 18:19:27,047 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 30.1 kB received in 558 messages, session time 126 s.
2025-07-31 18:19:27,048 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:19:27,049 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:19:32,312 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:19:32,313 - ib_insync.client - INFO - Connected
2025-07-31 18:19:32,316 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:19:32,367 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:19:32,367 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 19, 32, 366516, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:19:32,368 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:19:32,368 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 19, 32, 367833, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:19:32,368 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:19:32,369 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 19, 32, 367833, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:19:32,369 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:19:32,369 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:19:32,369 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:19:32,369 - ib_insync.client - INFO - API connection ready
2025-07-31 18:19:32,371 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:19:32,674 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.05000305, marketValue=848.2, averageCost=200.46255, unrealizedPNL=46.35, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:19:32,776 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:19:32,798 - root - ERROR - An error occurred in the WebSocket for AAPL: MockBroker.stream_market_data() takes 3 positional arguments but 4 were given
2025-07-31 18:19:32,798 - root - INFO - WebSocket for AAPL closed and cleaned up.
2025-07-31 18:20:31,598 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0, marketValue=848.0, averageCost=200.46255, unrealizedPNL=46.15, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:21:12,043 - root - INFO - Data gap found for AAPL. Fetching from broker from 2025-05-31 00:00:01 to 2025-06-01.
2025-07-31 18:21:50,340 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 207 B sent in 9 messages, 30.2 kB received in 559 messages, session time 138 s.
2025-07-31 18:21:50,341 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:21:50,341 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:21:55,774 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:21:55,774 - ib_insync.client - INFO - Connected
2025-07-31 18:21:55,777 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:21:55,819 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:21:55,819 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 21, 55, 818660, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:21:55,819 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:21:55,820 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 21, 55, 819626, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:21:55,820 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:21:55,820 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 21, 55, 819626, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:21:55,821 - ib_insync.client - INFO - API connection ready
2025-07-31 18:21:55,821 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:21:55,821 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:21:55,821 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:21:55,823 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:21:56,127 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0, marketValue=848.0, averageCost=200.46255, unrealizedPNL=46.15, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:21:56,228 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:23:02,004 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 66.6 s.
2025-07-31 18:23:02,004 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:23:02,006 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:23:08,668 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:23:08,669 - ib_insync.client - INFO - Connected
2025-07-31 18:23:08,672 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:23:08,709 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:23:08,709 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 23, 8, 708490, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:23:08,709 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:23:08,710 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 23, 8, 709544, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:23:08,710 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:23:08,710 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 23, 8, 709544, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:23:08,711 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:23:08,711 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:23:08,711 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:23:08,711 - ib_insync.client - INFO - API connection ready
2025-07-31 18:23:08,713 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:23:09,017 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=212.0, marketValue=848.0, averageCost=200.46255, unrealizedPNL=46.15, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:23:09,121 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:23:19,350 - root - INFO - Data gap found for AAPL. Fetching from broker from 2025-05-31 00:00:01 to 2025-06-01.
2025-07-31 18:23:21,095 - root - INFO - Data gap found for AAPL. Fetching from broker from 2025-05-31 00:00:01 to 2025-06-01.
2025-07-31 18:23:22,591 - root - INFO - Data gap found for AAPL. Fetching from broker from 2025-05-31 00:00:01 to 2025-06-01.
2025-07-31 18:23:31,566 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8500061, marketValue=847.4, averageCost=200.46255, unrealizedPNL=45.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:24:04,434 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 385 B sent in 11 messages, 30.5 kB received in 561 messages, session time 56.1 s.
2025-07-31 18:24:04,434 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:24:04,434 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:24:09,599 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:24:09,600 - ib_insync.client - INFO - Connected
2025-07-31 18:24:09,603 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:24:09,634 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:09,634 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 9, 633843, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 9, 634735, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 9, 634735, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:24:09,635 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:24:09,636 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:24:09,636 - ib_insync.client - INFO - API connection ready
2025-07-31 18:24:09,637 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:24:09,939 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8500061, marketValue=847.4, averageCost=200.46255, unrealizedPNL=45.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:24:10,043 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:24:39,189 - ib_insync.ib - INFO - Disconnecting from 127.0.0.1:4002, 119 B sent in 8 messages, 23.2 kB received in 410 messages, session time 29.9 s.
2025-07-31 18:24:39,190 - ib_insync.client - INFO - Disconnecting
2025-07-31 18:24:39,191 - ib_insync.client - INFO - Disconnected.
2025-07-31 18:24:45,750 - ib_insync.client - INFO - Connecting to 127.0.0.1:4002 with clientId 199...
2025-07-31 18:24:45,750 - ib_insync.client - INFO - Connected
2025-07-31 18:24:45,753 - ib_insync.client - INFO - Logged on to server version 176
2025-07-31 18:24:45,787 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:45,787 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=6, clientId=199, permId=1445720806, action='SELL', totalQuantity=10.0, orderType='STP', lmtPrice=0.0, auxPrice=145.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=145.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=6, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720806, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child,trigger', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 45, 786551, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:45,788 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:45,788 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=5, clientId=199, permId=1445720805, action='SELL', totalQuantity=10.0, orderType='LMT', lmtPrice=155.0, auxPrice=0.0, tif='DAY', ocaGroup='1445720804', ocaType=3, parentId=4, displaySize=2147483647, trailStopPrice=156.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=5, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720805, parentId=4, lastFillPrice=0.0, clientId=199, whyHeld='child', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 45, 787712, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:45,788 - ib_insync.wrapper - INFO - openOrder: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=0.0, avgFillPrice=0.0, permId=0, parentId=0, lastFillPrice=0.0, clientId=0, whyHeld='', mktCapPrice=0.0), fills=[], log=[], advancedError='')
2025-07-31 18:24:45,789 - ib_insync.wrapper - INFO - orderStatus: Trade(contract=Stock(conId=265598, symbol='AAPL', right='?', exchange='SMART', currency='USD', localSymbol='AAPL', tradingClass='NMS'), order=Order(orderId=4, clientId=199, permId=1445720804, action='BUY', totalQuantity=10.0, orderType='LMT', lmtPrice=150.0, auxPrice=0.0, tif='DAY', ocaType=3, displaySize=2147483647, trailStopPrice=151.0, openClose='', volatilityType=0, deltaNeutralOrderType='None', referencePriceType=0, account='DU7910303', clearingIntent='IB', adjustedOrderType='None', cashQty=0.0, dontUseAutoPriceForHedge=True), orderStatus=OrderStatus(orderId=4, status='PreSubmitted', filled=0.0, remaining=10.0, avgFillPrice=0.0, permId=1445720804, parentId=0, lastFillPrice=0.0, clientId=199, whyHeld='', mktCapPrice=0.0), fills=[], log=[TradeLogEntry(time=datetime.datetime(2025, 7, 31, 23, 24, 45, 787712, tzinfo=datetime.timezone.utc), status='PreSubmitted', message='', errorCode=0)], advancedError='')
2025-07-31 18:24:45,789 - ib_insync.wrapper - INFO - Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-07-31 18:24:45,789 - ib_insync.client - INFO - API connection ready
2025-07-31 18:24:45,789 - ib_insync.wrapper - INFO - Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-07-31 18:24:45,790 - ib_insync.wrapper - INFO - Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefil
2025-07-31 18:24:45,790 - ib_insync.wrapper - INFO - position: Position(account='DU7910303', contract=Stock(conId=265598, symbol='AAPL', exchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, avgCost=200.46255)
2025-07-31 18:24:46,094 - ib_insync.wrapper - INFO - updatePortfolio: PortfolioItem(contract=Stock(conId=265598, symbol='AAPL', right='0', primaryExchange='NASDAQ', currency='USD', localSymbol='AAPL', tradingClass='NMS'), position=4.0, marketPrice=211.8500061, marketValue=847.4, averageCost=200.46255, unrealizedPNL=45.55, realizedPNL=0.0, account='DU7910303')
2025-07-31 18:24:46,195 - ib_insync.ib - INFO - Synchronization complete
2025-07-31 18:25:09,693 - root - ERROR - An error occurred in the WebSocket for AAPL: MockBroker.stream_market_data() takes 3 positional arguments but 4 were given
2025-07-31 18:25:09,694 - root - INFO - WebSocket for AAPL closed and cleaned up.
